{% load render_table from django_tables2 %}
{% load querystring from django_tables2 %}
{% load delete_modal %}


<div class="container-fluid inline-table">
  <div class="row">
    <div class="table-responsive">

    {% comment %} <!-- Sidebar -->
    {% include "better_django_tables/filters/sidebar_filter.html" %} {% endcomment %}

    {% comment %} {% if links %}
      <div class='links'>
        {% for link in links %}
          <a href="{{ link.url }}">{{ link.text }}</a>
          <a type="button " class="btn btn-sm {{link.button_type}}" href="{{link.url}}">{{link.label}}</a>
        {% endfor %}
      </div>
      <br>
    {% endif %} {% endcomment %}

    <!-- Table Name and Controls Row -->
      <div class="d-flex justify-content-between align-items-center mb-1">
        <!-- Table Name -->
        <div>
          {% if table.table_name and show_table_name is True %}
            <h4 class="mb-0">{{table.table_name}}</h4>
          {% endif %}
        </div>

        <!-- Controls -->
        <div class="d-flex gap-2">
          <!-- Active Filters Badges -->
          {% include "better_django_tables/filters/active_filter_badges.html" with show_filter_badges=htmx_show_filter_badges %}

          <!-- Search Bar -->
          {% include "better_django_tables/filters/searchbar_filter.html" %}

          {% comment %} <!-- Reports Section -->
          {% if available_reports is not None and htmx_show_reports %}
            {% include "better_django_tables/reports/reports.html" %}
          {% endif %} {% endcomment %}

          <!-- Create URL -->
          {% if show_new_record %}
            <div class="col-auto">
              {% if table.add_create_button %}
                <a href="{% url table.create_url %}" class="btn btn-outline-primary btn-sm" role="button" aria-pressed="true">
                  <i class="bi bi-plus-lg"></i> {% if table.create_url_label %}{{table.create_url_label}}{% else %}New Record{% endif %}
                </a>
              {% endif %}
            </div>
          {% endif %}

          <!-- Per Page Selector -->
          {% if htmx_show_per_page %}
            <div class="col-auto">
              {% include "better_django_tables/partials/per_page_selector.html" %}
            </div>
          {% endif %}

          <!-- Export Buttons -->
          {% if exportable %}
            <div class="col-auto">
              <a class="btn btn-info btn-sm" href="{% querystring '_export'='csv' %}" role="button">Export CSV</a>
            </div>
          {% endif %}
        </div>
      </div>
      <!-- End Table Name and Controls Row -->

      {% if column_selection_form %}
        {% include "mutablecolumns/form.html" %}
      {% endif %}

      {% include "better_django_tables/partials/bulk_actions.html" %}

      {% render_table table table.htmx_template_name %}

    </div>
  </div>
</div>

{% if not delete_modal_loaded %}
    {% render_delete_modal table %}
    {% with delete_modal_loaded=True %}
    {% endwith %}
{% endif %}


{% comment %} {% block javascript %}
  <script src="{% static 'better_django_tables/js/bulk_actions.js' %}"></script>
{% endblock %} {% endcomment %}
